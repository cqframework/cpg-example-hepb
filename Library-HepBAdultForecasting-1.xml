<?xml version="1.0" encoding="UTF-8"?>
<library xmlns="urn:hl7-org:elm:r1" xmlns:t="urn:hl7-org:elm-types:r1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:fhir="http://hl7.org/fhir" xmlns:qdm43="urn:healthit-gov:qdm:v4_3" xmlns:qdm53="urn:healthit-gov:qdm:v5_3" xmlns:a="urn:hl7-org:cql-annotations:r1">
   <annotation translatorOptions="EnableAnnotations,EnableLocators,DisableListDemotion,DisableListPromotion" signatureLevel="None" xsi:type="a:CqlToElmInfo"/>
   <annotation message="The function FHIRHelpers.ToInterval has multiple overloads and due to the SignatureLevel setting (None), the overload signature is not being included in the output. This may result in ambiguous function resolution at runtime, consider setting the SignatureLevel to Overloads or All to ensure that the output includes sufficient information to support correct overload selection at runtime." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation message="The function FHIRHelpers.ToInterval has multiple overloads and due to the SignatureLevel setting (None), the overload signature is not being included in the output. This may result in ambiguous function resolution at runtime, consider setting the SignatureLevel to Overloads or All to ensure that the output includes sufficient information to support correct overload selection at runtime." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation librarySystem="http://hl7.org/fhir/uv/cpg/hepb" libraryId="HepBAdultForecasting" libraryVersion="0.1.0" startLine="93" startChar="3" endLine="93" endChar="60" message="Could not resolve membership operator for terminology target of the retrieve." errorType="semantic" errorSeverity="warning" xsi:type="a:CqlToElmError"/>
   <annotation xsi:type="a:Annotation">
      <a:s r="44">
         <a:s>/*
  This example describes the logic of the Hepatitis B (Hep B) immunization schedule for adults who are 18 years or older and have not yet been vaccinated for Hep B.
  It is provided for demonstration purposes and not intended to be a complete representation of all of the Hep B immunization schedule logic.
  See accompanying documentation for additional details and references.
*/
library HepBAdultForecasting version '0.1.0'</a:s>
      </a:s>
   </annotation>
   <identifier id="HepBAdultForecasting" system="http://hl7.org/fhir/uv/cpg/hepb" version="0.1.0"/>
   <schemaIdentifier id="urn:hl7-org:elm" version="r1"/>
   <usings>
      <def localIdentifier="System" uri="urn:hl7-org:elm-types:r1"/>
      <def localId="1" locator="8:1-8:26" localIdentifier="FHIR" uri="http://hl7.org/fhir" version="4.0.1">
         <annotation xsi:type="a:Annotation">
            <a:s r="1">
               <a:s>using </a:s>
               <a:s>
                  <a:s>FHIR</a:s>
               </a:s>
               <a:s> version '4.0.1'</a:s>
            </a:s>
         </annotation>
      </def>
   </usings>
   <includes>
      <def localId="2" locator="10:1-10:54" localIdentifier="FHIRHelpers" path="http://hl7.org/fhir/FHIRHelpers" version="4.0.1">
         <annotation xsi:type="a:Annotation">
            <a:s r="2">
               <a:s>include </a:s>
               <a:s>
                  <a:s>FHIRHelpers</a:s>
               </a:s>
               <a:s> version '4.0.1' called FHIRHelpers</a:s>
            </a:s>
         </annotation>
      </def>
   </includes>
   <codeSystems>
      <def localId="3" locator="12:1-12:45" name="CVX" id="http://hl7.org/fhir/sid/cvx" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="3">
               <a:s>codesystem CVX: 'http://hl7.org/fhir/sid/cvx'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="4" locator="13:1-13:131" name="Immunization Evaluation Dose Status codes" id="http://terminology.hl7.org/CodeSystem/immunization-evaluation-dose-status" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="4">
               <a:s>codesystem &quot;Immunization Evaluation Dose Status codes&quot;: 'http://terminology.hl7.org/CodeSystem/immunization-evaluation-dose-status'</a:s>
            </a:s>
         </annotation>
      </def>
   </codeSystems>
   <valueSets>
      <def localId="5" locator="16:1-16:90" name="All Hep B Vaccines" id="http://example.org/fhir/uv/cpg/ValueSet/all-hepb-vaccines" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="5">
               <a:s>// Valuesets
valueset &quot;All Hep B Vaccines&quot;: 'http://example.org/fhir/uv/cpg/ValueSet/all-hepb-vaccines'</a:s>
            </a:s>
         </annotation>
      </def>
   </valueSets>
   <codes>
      <def localId="7" locator="20:1-20:55" name="DTaP-IPV-Hib-Hep B, historical" id="132" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="7">
               <a:s>// Hep B Vaccine Codes
code &quot;DTaP-IPV-Hib-Hep B, historical&quot;: '132' from </a:s>
               <a:s r="6">
                  <a:s>&quot;CVX&quot;</a:s>
               </a:s>
            </a:s>
         </annotation>
         <codeSystem localId="6" locator="20:51-20:55" name="CVX"/>
      </def>
      <def localId="9" locator="21:1-21:46" name="DTaP, IPV, Hib, Hep B" id="146" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="9">
               <a:s>code &quot;DTaP, IPV, Hib, Hep B&quot;: '146' from </a:s>
               <a:s r="8">
                  <a:s>&quot;CVX&quot;</a:s>
               </a:s>
            </a:s>
         </annotation>
         <codeSystem localId="8" locator="21:42-21:46" name="CVX"/>
      </def>
      <def localId="11" locator="22:1-22:39" name="DTaP-Hep B-IPV" id="110" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="11">
               <a:s>code &quot;DTaP-Hep B-IPV&quot;: '110' from </a:s>
               <a:s r="10">
                  <a:s>&quot;CVX&quot;</a:s>
               </a:s>
            </a:s>
         </annotation>
         <codeSystem localId="10" locator="22:35-22:39" name="CVX"/>
      </def>
      <def localId="13" locator="23:1-23:38" name="DTP-Hib-Hep B" id="102" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="13">
               <a:s>code &quot;DTP-Hib-Hep B&quot;: '102' from </a:s>
               <a:s r="12">
                  <a:s>&quot;CVX&quot;</a:s>
               </a:s>
            </a:s>
         </annotation>
         <codeSystem localId="12" locator="23:34-23:38" name="CVX"/>
      </def>
      <def localId="15" locator="24:1-24:36" name="Hep A-Hep B" id="104" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="15">
               <a:s>code &quot;Hep A-Hep B&quot;: '104' from </a:s>
               <a:s r="14">
                  <a:s>&quot;CVX&quot;</a:s>
               </a:s>
            </a:s>
         </annotation>
         <codeSystem localId="14" locator="24:32-24:36" name="CVX"/>
      </def>
      <def localId="17" locator="25:1-25:58" name="Hep B, adolescent/high risk infant" id="42" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="17">
               <a:s>code &quot;Hep B, adolescent/high risk infant&quot;: '42' from </a:s>
               <a:s r="16">
                  <a:s>&quot;CVX&quot;</a:s>
               </a:s>
            </a:s>
         </annotation>
         <codeSystem localId="16" locator="25:54-25:58" name="CVX"/>
      </def>
      <def localId="19" locator="26:1-26:36" name="Hep B, adult" id="43" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="19">
               <a:s>code &quot;Hep B, adult&quot;: '43' from </a:s>
               <a:s r="18">
                  <a:s>&quot;CVX&quot;</a:s>
               </a:s>
            </a:s>
         </annotation>
         <codeSystem localId="18" locator="26:32-26:36" name="CVX"/>
      </def>
      <def localId="21" locator="27:1-27:39" name="Hep B, dialysis" id="44" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="21">
               <a:s>code &quot;Hep B, dialysis&quot;: '44' from </a:s>
               <a:s r="20">
                  <a:s>&quot;CVX&quot;</a:s>
               </a:s>
            </a:s>
         </annotation>
         <codeSystem localId="20" locator="27:35-27:39" name="CVX"/>
      </def>
      <def localId="23" locator="28:1-28:54" name="Hep B, unspecified formulation" id="45" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="23">
               <a:s>code &quot;Hep B, unspecified formulation&quot;: '45' from </a:s>
               <a:s r="22">
                  <a:s>&quot;CVX&quot;</a:s>
               </a:s>
            </a:s>
         </annotation>
         <codeSystem localId="22" locator="28:50-28:54" name="CVX"/>
      </def>
      <def localId="25" locator="29:1-29:55" name="Hep B Vaccine Code, Adjuvanted" id="189" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="25">
               <a:s>code &quot;Hep B Vaccine Code, Adjuvanted&quot;: '189' from </a:s>
               <a:s r="24">
                  <a:s>&quot;CVX&quot;</a:s>
               </a:s>
            </a:s>
         </annotation>
         <codeSystem localId="24" locator="29:51-29:55" name="CVX"/>
      </def>
      <def localId="27" locator="30:1-30:33" name="Hib-Hep B" id="51" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="27">
               <a:s>code &quot;Hib-Hep B&quot;: '51' from </a:s>
               <a:s r="26">
                  <a:s>&quot;CVX&quot;</a:s>
               </a:s>
            </a:s>
         </annotation>
         <codeSystem localId="26" locator="30:29-30:33" name="CVX"/>
      </def>
      <def localId="29" locator="33:1-33:88" name="Valid Evaluation Status" id="valid" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="29">
               <a:s>// Evaluation Status Code
code &quot;Valid Evaluation Status&quot;: 'valid' from </a:s>
               <a:s r="28">
                  <a:s>&quot;Immunization Evaluation Dose Status codes&quot;</a:s>
               </a:s>
            </a:s>
         </annotation>
         <codeSystem localId="28" locator="33:46-33:88" name="Immunization Evaluation Dose Status codes"/>
      </def>
   </codes>
   <concepts>
      <def localId="31" locator="36:1-36:73" name="Hep B Vaccine, Adjuvanted" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="31">
               <a:s>// Concept
concept &quot;Hep B Vaccine, Adjuvanted&quot;: { </a:s>
               <a:s r="30">
                  <a:s>&quot;Hep B Vaccine Code, Adjuvanted&quot;</a:s>
               </a:s>
               <a:s> }</a:s>
            </a:s>
         </annotation>
         <code localId="30" locator="36:40-36:71" name="Hep B Vaccine Code, Adjuvanted"/>
      </def>
   </concepts>
   <contexts>
      <def locator="39:1-39:15" name="Patient"/>
   </contexts>
   <statements>
      <def locator="39:1-39:15" name="Patient" context="Patient">
         <expression xsi:type="SingletonFrom">
            <operand locator="39:1-39:15" dataType="fhir:Patient" templateId="http://hl7.org/fhir/StructureDefinition/Patient" xsi:type="Retrieve"/>
         </expression>
      </def>
      <def localId="36" locator="141:1-142:25" name="PatientBirthDate" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="36">
               <a:s>define PatientBirthDate:
  </a:s>
               <a:s r="35">
                  <a:s r="34">
                     <a:s r="33">
                        <a:s>Patient</a:s>
                     </a:s>
                     <a:s>.</a:s>
                     <a:s r="34">
                        <a:s>birthDate</a:s>
                     </a:s>
                  </a:s>
                  <a:s>.</a:s>
                  <a:s r="35">
                     <a:s>value</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="35" locator="142:3-142:25" path="value" xsi:type="Property">
            <source localId="34" locator="142:3-142:19" path="birthDate" xsi:type="Property">
               <source localId="33" locator="142:3-142:9" name="Patient" xsi:type="ExpressionRef"/>
            </source>
         </expression>
      </def>
      <def localId="44" locator="144:1-145:78" name="Age in Days when Patient is 18 Years minus 4 Days" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="44">
               <a:s>define &quot;Age in Days when Patient is 18 Years minus 4 Days&quot;:
  </a:s>
               <a:s r="43">
                  <a:s>CalculateAgeInDaysAt(</a:s>
                  <a:s r="37">
                     <a:s>PatientBirthDate</a:s>
                  </a:s>
                  <a:s>, </a:s>
                  <a:s r="42">
                     <a:s r="40">
                        <a:s r="38">
                           <a:s>PatientBirthDate</a:s>
                        </a:s>
                        <a:s> + </a:s>
                        <a:s r="39">
                           <a:s>18 years</a:s>
                        </a:s>
                     </a:s>
                     <a:s> - </a:s>
                     <a:s r="41">
                        <a:s>4 days</a:s>
                     </a:s>
                  </a:s>
                  <a:s>)</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="43" locator="145:3-145:78" precision="Day" xsi:type="CalculateAgeAt">
            <operand localId="37" locator="145:24-145:39" name="PatientBirthDate" xsi:type="ExpressionRef"/>
            <operand localId="42" locator="145:42-145:77" xsi:type="Subtract">
               <operand localId="40" locator="145:42-145:68" xsi:type="Add">
                  <operand localId="38" locator="145:42-145:57" name="PatientBirthDate" xsi:type="ExpressionRef"/>
                  <operand localId="39" locator="145:61-145:68" value="18" unit="years" xsi:type="Quantity"/>
               </operand>
               <operand localId="41" locator="145:72-145:77" value="4" unit="days" xsi:type="Quantity"/>
            </operand>
         </expression>
      </def>
      <def localId="47" locator="48:1-49:68" name="Patient is 18 Years Minus 4 Days or Older" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="47">
               <a:s>define &quot;Patient is 18 Years Minus 4 Days or Older&quot;:
  </a:s>
               <a:s r="46">
                  <a:s r="32">
                     <a:s>AgeInDays()</a:s>
                  </a:s>
                  <a:s> >= </a:s>
                  <a:s r="45">
                     <a:s>&quot;Age in Days when Patient is 18 Years minus 4 Days&quot;</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="46" locator="49:3-49:68" xsi:type="GreaterOrEqual">
            <operand localId="32" locator="49:3-49:13" precision="Day" xsi:type="CalculateAge">
               <operand xsi:type="ToDateTime">
                  <operand path="birthDate.value" xsi:type="Property">
                     <source name="Patient" xsi:type="ExpressionRef"/>
                  </operand>
               </operand>
            </operand>
            <operand localId="45" locator="49:18-49:68" name="Age in Days when Patient is 18 Years minus 4 Days" xsi:type="ExpressionRef"/>
         </expression>
      </def>
      <def localId="65" locator="51:1-54:3" name="No Hep B Shots were Administered before 18 Years minus 4 Days of Age" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="65">
               <a:s>define &quot;No Hep B Shots were Administered before 18 Years minus 4 Days of Age&quot;:
  </a:s>
               <a:s r="64">
                  <a:s>not </a:s>
                  <a:s r="63">
                     <a:s>exists</a:s>
                     <a:s r="62">
                        <a:s>(</a:s>
                        <a:s r="62">
                           <a:s>
                              <a:s r="50">
                                 <a:s r="49">
                                    <a:s r="49">
                                       <a:s>[Immunization: </a:s>
                                       <a:s>
                                          <a:s>vaccineCode</a:s>
                                       </a:s>
                                       <a:s> in </a:s>
                                       <a:s>
                                          <a:s>&quot;All Hep B Vaccines&quot;</a:s>
                                       </a:s>
                                       <a:s>]</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> NI</a:s>
                              </a:s>
                           </a:s>
                           <a:s>
    </a:s>
                           <a:s r="61">
                              <a:s>where </a:s>
                              <a:s r="61">
                                 <a:s r="54">
                                    <a:s r="52">
                                       <a:s r="51">
                                          <a:s>NI</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="52">
                                          <a:s>occurrence</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> is </a:s>
                                    <a:s r="53">
                                       <a:s>date</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> and </a:s>
                                 <a:s r="60">
                                    <a:s r="58">
                                       <a:s>AgeInDaysAt(</a:s>
                                       <a:s r="57">
                                          <a:s r="56">
                                             <a:s r="55">
                                                <a:s>NI</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="56">
                                                <a:s>occurrence</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="57">
                                             <a:s>value</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>)</a:s>
                                    </a:s>
                                    <a:s> &lt; </a:s>
                                    <a:s r="59">
                                       <a:s>&quot;Age in Days when Patient is 18 Years minus 4 Days&quot;</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>
  )</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="64" locator="52:3-54:3" xsi:type="Not">
            <operand localId="63" locator="52:7-54:3" xsi:type="Exists">
               <operand localId="62" locator="52:13-54:3" xsi:type="Query">
                  <source localId="50" locator="52:14-52:67" alias="NI">
                     <expression localId="49" locator="52:14-52:64" dataType="fhir:Immunization" templateId="http://hl7.org/fhir/StructureDefinition/Immunization" codeProperty="vaccineCode" codeComparator="in" xsi:type="Retrieve">
                        <codes locator="52:44-52:63" name="All Hep B Vaccines" preserve="true" xsi:type="ValueSetRef"/>
                     </expression>
                  </source>
                  <where localId="61" locator="53:5-53:122" xsi:type="And">
                     <operand localId="54" locator="53:11-53:31" xsi:type="Is">
                        <operand localId="52" locator="53:11-53:23" path="occurrence" scope="NI" xsi:type="Property"/>
                        <isTypeSpecifier localId="53" locator="53:28-53:31" name="fhir:date" xsi:type="NamedTypeSpecifier"/>
                     </operand>
                     <operand localId="60" locator="53:37-53:122" xsi:type="Less">
                        <operand localId="58" locator="53:37-53:68" precision="Day" xsi:type="CalculateAgeAt">
                           <operand xsi:type="ToDateTime">
                              <operand path="birthDate.value" xsi:type="Property">
                                 <source name="Patient" xsi:type="ExpressionRef"/>
                              </operand>
                           </operand>
                           <operand asType="t:DateTime" xsi:type="As">
                              <operand localId="57" locator="53:49-53:67" path="value" xsi:type="Property">
                                 <source localId="56" locator="53:49-53:61" path="occurrence" scope="NI" xsi:type="Property"/>
                              </operand>
                           </operand>
                        </operand>
                        <operand localId="59" locator="53:72-53:122" name="Age in Days when Patient is 18 Years minus 4 Days" xsi:type="ExpressionRef"/>
                     </operand>
                  </where>
               </operand>
            </operand>
         </expression>
      </def>
      <def localId="69" locator="92:1-93:60" name="Hep B Vaccine, Adjuvanted Immunization" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="69">
               <a:s>////////////////////////////////////////////////////////
// Evaluation
////////////////////////////////////////////////////////
define &quot;Hep B Vaccine, Adjuvanted Immunization&quot;:
  </a:s>
               <a:s r="68">
                  <a:s>[Immunization: </a:s>
                  <a:s>
                     <a:s>vaccineCode</a:s>
                  </a:s>
                  <a:s> in </a:s>
                  <a:s>
                     <a:s>&quot;Hep B Vaccine, Adjuvanted&quot;</a:s>
                  </a:s>
                  <a:s>]</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="68" locator="93:3-93:60" dataType="fhir:Immunization" templateId="http://hl7.org/fhir/StructureDefinition/Immunization" codeProperty="vaccineCode" codeComparator="in" xsi:type="Retrieve">
            <codes xsi:type="ToList">
               <operand locator="93:33-93:59" name="Hep B Vaccine, Adjuvanted" xsi:type="ConceptRef"/>
            </codes>
         </expression>
      </def>
      <def localId="108" locator="111:1-118:3" name="First Valid Hep B Adjuvanted Adult Dose" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="108">
               <a:s>define &quot;First Valid Hep B Adjuvanted Adult Dose&quot;:
  </a:s>
               <a:s r="107">
                  <a:s>First(
    </a:s>
                  <a:s r="106">
                     <a:s>
                        <a:s r="71">
                           <a:s r="70">
                              <a:s>
                                 <a:s>&quot;Hep B Vaccine, Adjuvanted Immunization&quot;</a:s>
                              </a:s>
                           </a:s>
                           <a:s> I</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
      </a:s>
                     <a:s r="100">
                        <a:s>without </a:s>
                        <a:s r="73">
                           <a:s r="72">
                              <a:s>
                                 <a:s>&quot;Hep B Vaccine, Adjuvanted Immunization&quot;</a:s>
                              </a:s>
                           </a:s>
                           <a:s> NI</a:s>
                        </a:s>
                        <a:s>
        such that </a:s>
                        <a:s r="99">
                           <a:s r="91">
                              <a:s r="85">
                                 <a:s r="78">
                                    <a:s r="76">
                                       <a:s r="75">
                                          <a:s r="74">
                                             <a:s>I</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="75">
                                             <a:s>occurrence</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="76">
                                          <a:s>value</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> is </a:s>
                                    <a:s r="77">
                                       <a:s>DateTime</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> and </a:s>
                                 <a:s r="84">
                                    <a:s r="82">
                                       <a:s>AgeInDaysAt(</a:s>
                                       <a:s r="81">
                                          <a:s r="80">
                                             <a:s r="79">
                                                <a:s>I</a:s>
                                             </a:s>
                                             <a:s>.</a:s>
                                             <a:s r="80">
                                                <a:s>occurrence</a:s>
                                             </a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="81">
                                             <a:s>value</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>)</a:s>
                                    </a:s>
                                    <a:s> >= </a:s>
                                    <a:s r="83">
                                       <a:s>&quot;Age in Days when Patient is 18 Years minus 4 Days&quot;</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
          and </a:s>
                              <a:s r="90">
                                 <a:s r="88">
                                    <a:s r="87">
                                       <a:s r="86">
                                          <a:s>NI</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="87">
                                          <a:s>occurrence</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="88">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> is </a:s>
                                 <a:s r="89">
                                    <a:s>DateTime</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s> and </a:s>
                           <a:s r="98">
                              <a:s r="94">
                                 <a:s r="93">
                                    <a:s r="92">
                                       <a:s>NI</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="93">
                                       <a:s>occurrence</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="94">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                              <a:s r="98"> before </a:s>
                              <a:s r="97">
                                 <a:s r="96">
                                    <a:s r="95">
                                       <a:s>I</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="96">
                                       <a:s>occurrence</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="97">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
      </a:s>
                     <a:s r="105">
                        <a:s>where </a:s>
                        <a:s r="105">
                           <a:s r="103">
                              <a:s r="102">
                                 <a:s r="101">
                                    <a:s>I</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="102">
                                    <a:s>occurrence</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="103">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                           <a:s> is </a:s>
                           <a:s r="104">
                              <a:s>DateTime</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
                  <a:s>
  )</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="107" locator="112:3-118:3" xsi:type="First">
            <source localId="106" locator="113:5-117:42" xsi:type="Query">
               <source localId="71" locator="113:5-113:46" alias="I">
                  <expression localId="70" locator="113:5-113:44" name="Hep B Vaccine, Adjuvanted Immunization" xsi:type="ExpressionRef"/>
               </source>
               <relationship localId="100" locator="114:7-116:95" alias="NI" xsi:type="Without">
                  <expression localId="72" locator="114:15-114:54" name="Hep B Vaccine, Adjuvanted Immunization" xsi:type="ExpressionRef"/>
                  <suchThat localId="99" locator="115:19-116:95" xsi:type="And">
                     <operand localId="91" locator="115:19-116:45" xsi:type="And">
                        <operand localId="85" locator="115:19-115:139" xsi:type="And">
                           <operand localId="78" locator="115:19-115:48" xsi:type="Is">
                              <operand localId="76" locator="115:19-115:36" path="value" xsi:type="Property">
                                 <source localId="75" locator="115:19-115:30" path="occurrence" scope="I" xsi:type="Property"/>
                              </operand>
                              <isTypeSpecifier localId="77" locator="115:41-115:48" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                           </operand>
                           <operand localId="84" locator="115:54-115:139" xsi:type="GreaterOrEqual">
                              <operand localId="82" locator="115:54-115:84" precision="Day" xsi:type="CalculateAgeAt">
                                 <operand xsi:type="ToDateTime">
                                    <operand path="birthDate.value" xsi:type="Property">
                                       <source name="Patient" xsi:type="ExpressionRef"/>
                                    </operand>
                                 </operand>
                                 <operand asType="t:DateTime" xsi:type="As">
                                    <operand localId="81" locator="115:66-115:83" path="value" xsi:type="Property">
                                       <source localId="80" locator="115:66-115:77" path="occurrence" scope="I" xsi:type="Property"/>
                                    </operand>
                                 </operand>
                              </operand>
                              <operand localId="83" locator="115:89-115:139" name="Age in Days when Patient is 18 Years minus 4 Days" xsi:type="ExpressionRef"/>
                           </operand>
                        </operand>
                        <operand localId="90" locator="116:15-116:45" xsi:type="Is">
                           <operand localId="88" locator="116:15-116:33" path="value" xsi:type="Property">
                              <source localId="87" locator="116:15-116:27" path="occurrence" scope="NI" xsi:type="Property"/>
                           </operand>
                           <isTypeSpecifier localId="89" locator="116:38-116:45" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </operand>
                     </operand>
                     <operand localId="98" locator="116:51-116:95" xsi:type="Before">
                        <operand asType="t:DateTime" xsi:type="As">
                           <operand localId="94" locator="116:51-116:69" path="value" xsi:type="Property">
                              <source localId="93" locator="116:51-116:63" path="occurrence" scope="NI" xsi:type="Property"/>
                           </operand>
                        </operand>
                        <operand asType="t:DateTime" xsi:type="As">
                           <operand localId="97" locator="116:78-116:95" path="value" xsi:type="Property">
                              <source localId="96" locator="116:78-116:89" path="occurrence" scope="I" xsi:type="Property"/>
                           </operand>
                        </operand>
                     </operand>
                  </suchThat>
               </relationship>
               <where localId="105" locator="117:7-117:42" xsi:type="Is">
                  <operand localId="103" locator="117:13-117:30" path="value" xsi:type="Property">
                     <source localId="102" locator="117:13-117:24" path="occurrence" scope="I" xsi:type="Property"/>
                  </operand>
                  <isTypeSpecifier localId="104" locator="117:35-117:42" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
               </where>
            </source>
         </expression>
      </def>
      <def localId="115" locator="104:1-109:9" name="There Exists a Valid First Hep B Adjuvanted Dose" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="115">
               <a:s>define &quot;There Exists a Valid First Hep B Adjuvanted Dose&quot;:
  </a:s>
               <a:s r="114">
                  <a:s>if </a:s>
                  <a:s r="111">
                     <a:s r="109">
                        <a:s>&quot;First Valid Hep B Adjuvanted Adult Dose&quot;</a:s>
                     </a:s>
                     <a:s r="110"> != null</a:s>
                  </a:s>
                  <a:s r="112">
    then
      true
  else
    false</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="114" locator="105:3-109:9" xsi:type="If">
            <condition localId="111" locator="105:6-105:54" xsi:type="Not">
               <operand locator="105:6-105:54" xsi:type="Equal">
                  <operand localId="109" locator="105:6-105:46" name="First Valid Hep B Adjuvanted Adult Dose" xsi:type="ExpressionRef"/>
                  <operand asType="fhir:Immunization" xsi:type="As">
                     <operand localId="110" locator="105:51-105:54" xsi:type="Null"/>
                  </operand>
               </operand>
            </condition>
            <then localId="112" locator="107:7-107:10" valueType="t:Boolean" value="true" xsi:type="Literal"/>
            <else localId="113" locator="109:5-109:9" valueType="t:Boolean" value="false" xsi:type="Literal"/>
         </expression>
      </def>
      <def localId="122" locator="120:1-125:9" name="There Exists a Valid Second Hep B Adjuvanted Dose" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="122">
               <a:s>define &quot;There Exists a Valid Second Hep B Adjuvanted Dose&quot;:
  </a:s>
               <a:s r="121">
                  <a:s>if </a:s>
                  <a:s r="118">
                     <a:s>&quot;There Exists a Valid First Hep B Adjuvanted Dose&quot;</a:s>
                  </a:s>
                  <a:s r="119">
    then
      true
  else
    false</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="121" locator="121:3-125:9" xsi:type="If">
            <condition localId="118" locator="121:6-121:55" name="There Exists a Valid First Hep B Adjuvanted Dose" xsi:type="ExpressionRef"/>
            <then localId="119" locator="123:7-123:10" valueType="t:Boolean" value="true" xsi:type="Literal"/>
            <else localId="120" locator="125:5-125:9" valueType="t:Boolean" value="false" xsi:type="Literal"/>
         </expression>
      </def>
      <def localId="125" locator="41:1-46:53" name="Patient Hep B Immunization History should be Evaluated in Adult Series" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="125">
               <a:s>define &quot;Patient Hep B Immunization History should be Evaluated in Adult Series&quot;:
  </a:s>
               <a:s r="124">
                  <a:s r="117">
                     <a:s r="67">
                        <a:s r="48">
                           <a:s>&quot;Patient is 18 Years Minus 4 Days or Older&quot;</a:s>
                        </a:s>
                        <a:s> and </a:s>
                        <a:s r="66">
                           <a:s>&quot;No Hep B Shots were Administered before 18 Years minus 4 Days of Age&quot;</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  or
  </a:s>
                     <a:s r="116">
                        <a:s>&quot;There Exists a Valid First Hep B Adjuvanted Dose&quot;</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
  or
  </a:s>
                  <a:s r="123">
                     <a:s>&quot;There Exists a Valid Second Hep B Adjuvanted Dose&quot;</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="124" locator="42:3-46:53" xsi:type="Or">
            <operand localId="117" locator="42:3-44:52" xsi:type="Or">
               <operand localId="67" locator="42:3-42:120" xsi:type="And">
                  <operand localId="48" locator="42:3-42:45" name="Patient is 18 Years Minus 4 Days or Older" xsi:type="ExpressionRef"/>
                  <operand localId="66" locator="42:51-42:120" name="No Hep B Shots were Administered before 18 Years minus 4 Days of Age" xsi:type="ExpressionRef"/>
               </operand>
               <operand localId="116" locator="44:3-44:52" name="There Exists a Valid First Hep B Adjuvanted Dose" xsi:type="ExpressionRef"/>
            </operand>
            <operand localId="123" locator="46:3-46:53" name="There Exists a Valid Second Hep B Adjuvanted Dose" xsi:type="ExpressionRef"/>
         </expression>
      </def>
      <def localId="127" locator="59:1-60:96" name="Get Recommendation Overview" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="127">
               <a:s>////////////////////////////////////////////////////////
// Recommendation/Forecast
////////////////////////////////////////////////////////
define &quot;Get Recommendation Overview&quot;:
  </a:s>
               <a:s r="126">
                  <a:s>'Immunization Forecast of Hepatitis B, Adjuvanted Vaccine for Adults 18 Years of Age or Older'</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="126" locator="60:3-60:96" valueType="t:String" value="Immunization Forecast of Hepatitis B, Adjuvanted Vaccine for Adults 18 Years of Age or Older" xsi:type="Literal"/>
      </def>
      <def localId="136" locator="74:1-80:9" name="A Forecast for Hep B Adult Dose 1 Should be Made" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="136">
               <a:s>define &quot;A Forecast for Hep B Adult Dose 1 Should be Made&quot;:
  </a:s>
               <a:s r="135">
                  <a:s>if
    </a:s>
                  <a:s r="132">
                     <a:s r="128">
                        <a:s>&quot;Patient Hep B Immunization History should be Evaluated in Adult Series&quot;</a:s>
                     </a:s>
                     <a:s> and </a:s>
                     <a:s r="131">
                        <a:s r="129">
                           <a:s>&quot;There Exists a Valid First Hep B Adjuvanted Dose&quot;</a:s>
                        </a:s>
                        <a:s r="130"> = false</a:s>
                     </a:s>
                  </a:s>
                  <a:s r="133">
  then
    true
  else
    false</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="135" locator="75:3-80:9" xsi:type="If">
            <condition localId="132" locator="76:5-76:139" xsi:type="And">
               <operand localId="128" locator="76:5-76:76" name="Patient Hep B Immunization History should be Evaluated in Adult Series" xsi:type="ExpressionRef"/>
               <operand localId="131" locator="76:82-76:139" xsi:type="Equal">
                  <operand localId="129" locator="76:82-76:131" name="There Exists a Valid First Hep B Adjuvanted Dose" xsi:type="ExpressionRef"/>
                  <operand localId="130" locator="76:135-76:139" valueType="t:Boolean" value="false" xsi:type="Literal"/>
               </operand>
            </condition>
            <then localId="133" locator="78:5-78:8" valueType="t:Boolean" value="true" xsi:type="Literal"/>
            <else localId="134" locator="80:5-80:9" valueType="t:Boolean" value="false" xsi:type="Literal"/>
         </expression>
      </def>
      <def localId="154" locator="82:1-83:123" name="A Forecast for Hep B Adult Dose 2 Should be Made" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="154">
               <a:s>define &quot;A Forecast for Hep B Adult Dose 2 Should be Made&quot;:
  </a:s>
               <a:s r="153">
                  <a:s r="149">
                     <a:s r="147">
                        <a:s>&quot;There Exists a Valid First Hep B Adjuvanted Dose&quot;</a:s>
                     </a:s>
                     <a:s r="148"> = true</a:s>
                  </a:s>
                  <a:s> and </a:s>
                  <a:s r="152">
                     <a:s r="150">
                        <a:s>&quot;There Exists a Valid Second Hep B Adjuvanted Dose&quot;</a:s>
                     </a:s>
                     <a:s r="151"> = false</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="153" locator="83:3-83:123" xsi:type="And">
            <operand localId="149" locator="83:3-83:59" xsi:type="Equal">
               <operand localId="147" locator="83:3-83:52" name="There Exists a Valid First Hep B Adjuvanted Dose" xsi:type="ExpressionRef"/>
               <operand localId="148" locator="83:56-83:59" valueType="t:Boolean" value="true" xsi:type="Literal"/>
            </operand>
            <operand localId="152" locator="83:65-83:123" xsi:type="Equal">
               <operand localId="150" locator="83:65-83:115" name="There Exists a Valid Second Hep B Adjuvanted Dose" xsi:type="ExpressionRef"/>
               <operand localId="151" locator="83:119-83:123" valueType="t:Boolean" value="false" xsi:type="Literal"/>
            </operand>
         </expression>
      </def>
      <def localId="192" locator="95:1-102:3" name="Most Recent Hep B Adjuvanted Administration Date" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="192">
               <a:s>define &quot;Most Recent Hep B Adjuvanted Administration Date&quot;:
  </a:s>
               <a:s r="191">
                  <a:s>First(
    </a:s>
                  <a:s r="190">
                     <a:s>
                        <a:s r="158">
                           <a:s r="157">
                              <a:s>
                                 <a:s>&quot;Hep B Vaccine, Adjuvanted Immunization&quot;</a:s>
                              </a:s>
                           </a:s>
                           <a:s> I</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
      </a:s>
                     <a:s r="180">
                        <a:s>without </a:s>
                        <a:s r="160">
                           <a:s r="159">
                              <a:s>
                                 <a:s>&quot;Hep B Vaccine, Adjuvanted Immunization&quot;</a:s>
                              </a:s>
                           </a:s>
                           <a:s> NI</a:s>
                        </a:s>
                        <a:s>
        such that </a:s>
                        <a:s r="179">
                           <a:s r="171">
                              <a:s r="165">
                                 <a:s r="163">
                                    <a:s r="162">
                                       <a:s r="161">
                                          <a:s>I</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="162">
                                          <a:s>occurrence</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="163">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> is </a:s>
                                 <a:s r="164">
                                    <a:s>DateTime</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> and </a:s>
                              <a:s r="170">
                                 <a:s r="168">
                                    <a:s r="167">
                                       <a:s r="166">
                                          <a:s>NI</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="167">
                                          <a:s>occurrence</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="168">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> is </a:s>
                                 <a:s r="169">
                                    <a:s>DateTime</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s> and </a:s>
                           <a:s r="178">
                              <a:s r="174">
                                 <a:s r="173">
                                    <a:s r="172">
                                       <a:s>NI</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="173">
                                       <a:s>occurrence</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="174">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                              <a:s r="178"> after </a:s>
                              <a:s r="177">
                                 <a:s r="176">
                                    <a:s r="175">
                                       <a:s>I</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="176">
                                       <a:s>occurrence</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="177">
                                    <a:s>value</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
      </a:s>
                     <a:s r="185">
                        <a:s>where </a:s>
                        <a:s r="185">
                           <a:s r="183">
                              <a:s r="182">
                                 <a:s r="181">
                                    <a:s>I</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="182">
                                    <a:s>occurrence</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="183">
                                 <a:s>value</a:s>
                              </a:s>
                           </a:s>
                           <a:s> is </a:s>
                           <a:s r="184">
                              <a:s>DateTime</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
      </a:s>
                     <a:s r="189">
                        <a:s>return </a:s>
                        <a:s r="188">
                           <a:s r="187">
                              <a:s r="186">
                                 <a:s>I</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="187">
                                 <a:s>occurrence</a:s>
                              </a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="188">
                              <a:s>value</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
                  <a:s>
  )</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="191" locator="96:3-102:3" xsi:type="First">
            <source localId="190" locator="97:5-101:31" xsi:type="Query">
               <source localId="158" locator="97:5-97:46" alias="I">
                  <expression localId="157" locator="97:5-97:44" name="Hep B Vaccine, Adjuvanted Immunization" xsi:type="ExpressionRef"/>
               </source>
               <relationship localId="180" locator="98:7-99:133" alias="NI" xsi:type="Without">
                  <expression localId="159" locator="98:15-98:54" name="Hep B Vaccine, Adjuvanted Immunization" xsi:type="ExpressionRef"/>
                  <suchThat localId="179" locator="99:19-99:133" xsi:type="And">
                     <operand localId="171" locator="99:19-99:84" xsi:type="And">
                        <operand localId="165" locator="99:19-99:48" xsi:type="Is">
                           <operand localId="163" locator="99:19-99:36" path="value" xsi:type="Property">
                              <source localId="162" locator="99:19-99:30" path="occurrence" scope="I" xsi:type="Property"/>
                           </operand>
                           <isTypeSpecifier localId="164" locator="99:41-99:48" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </operand>
                        <operand localId="170" locator="99:54-99:84" xsi:type="Is">
                           <operand localId="168" locator="99:54-99:72" path="value" xsi:type="Property">
                              <source localId="167" locator="99:54-99:66" path="occurrence" scope="NI" xsi:type="Property"/>
                           </operand>
                           <isTypeSpecifier localId="169" locator="99:77-99:84" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </operand>
                     </operand>
                     <operand localId="178" locator="99:90-99:133" xsi:type="After">
                        <operand asType="t:DateTime" xsi:type="As">
                           <operand localId="174" locator="99:90-99:108" path="value" xsi:type="Property">
                              <source localId="173" locator="99:90-99:102" path="occurrence" scope="NI" xsi:type="Property"/>
                           </operand>
                        </operand>
                        <operand asType="t:DateTime" xsi:type="As">
                           <operand localId="177" locator="99:116-99:133" path="value" xsi:type="Property">
                              <source localId="176" locator="99:116-99:127" path="occurrence" scope="I" xsi:type="Property"/>
                           </operand>
                        </operand>
                     </operand>
                  </suchThat>
               </relationship>
               <where localId="185" locator="100:7-100:42" xsi:type="Is">
                  <operand localId="183" locator="100:13-100:30" path="value" xsi:type="Property">
                     <source localId="182" locator="100:13-100:24" path="occurrence" scope="I" xsi:type="Property"/>
                  </operand>
                  <isTypeSpecifier localId="184" locator="100:35-100:42" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
               </where>
               <return localId="189" locator="101:7-101:31">
                  <expression localId="188" locator="101:14-101:31" path="value" xsi:type="Property">
                     <source localId="187" locator="101:14-101:25" path="occurrence" scope="I" xsi:type="Property"/>
                  </expression>
               </return>
            </source>
         </expression>
      </def>
      <def localId="208" locator="85:1-86:122" name="Patient has Completed the Hep B Adult Series" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="208">
               <a:s>define &quot;Patient has Completed the Hep B Adult Series&quot;:
  </a:s>
               <a:s r="207">
                  <a:s r="203">
                     <a:s r="201">
                        <a:s>&quot;There Exists a Valid First Hep B Adjuvanted Dose&quot;</a:s>
                     </a:s>
                     <a:s r="202"> = true</a:s>
                  </a:s>
                  <a:s> and </a:s>
                  <a:s r="206">
                     <a:s r="204">
                        <a:s>&quot;There Exists a Valid Second Hep B Adjuvanted Dose&quot;</a:s>
                     </a:s>
                     <a:s r="205"> = true</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="207" locator="86:3-86:122" xsi:type="And">
            <operand localId="203" locator="86:3-86:59" xsi:type="Equal">
               <operand localId="201" locator="86:3-86:52" name="There Exists a Valid First Hep B Adjuvanted Dose" xsi:type="ExpressionRef"/>
               <operand localId="202" locator="86:56-86:59" valueType="t:Boolean" value="true" xsi:type="Literal"/>
            </operand>
            <operand localId="206" locator="86:65-86:122" xsi:type="Equal">
               <operand localId="204" locator="86:65-86:115" name="There Exists a Valid Second Hep B Adjuvanted Dose" xsi:type="ExpressionRef"/>
               <operand localId="205" locator="86:119-86:122" valueType="t:Boolean" value="true" xsi:type="Literal"/>
            </operand>
         </expression>
      </def>
      <def localId="214" locator="62:1-72:5" name="Get Recommendation Detail" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="214">
               <a:s>define &quot;Get Recommendation Detail&quot;:
  </a:s>
               <a:s r="213">
                  <a:s>case
    </a:s>
                  <a:s r="146">
                     <a:s>when </a:s>
                     <a:s r="137">
                        <a:s>&quot;A Forecast for Hep B Adult Dose 1 Should be Made&quot;</a:s>
                     </a:s>
                     <a:s>
      then </a:s>
                     <a:s r="145">
                        <a:s r="143">
                           <a:s r="138">
                              <a:s>'Dose 1 of the Hepatitus B, adjuvanted vaccine (CVX 189) is recommended to be administered on '</a:s>
                           </a:s>
                           <a:s> + </a:s>
                           <a:s r="142">
                              <a:s>ToString(</a:s>
                              <a:s r="141">
                                 <a:s r="139">
                                    <a:s>PatientBirthDate</a:s>
                                 </a:s>
                                 <a:s> + </a:s>
                                 <a:s r="140">
                                    <a:s>18 years</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s> + </a:s>
                        <a:s r="144">
                           <a:s>'.'</a:s>
                        </a:s>
                     </a:s>
                  </a:s>
                  <a:s>
    </a:s>
                  <a:s r="200">
                     <a:s>when </a:s>
                     <a:s r="155">
                        <a:s>&quot;A Forecast for Hep B Adult Dose 2 Should be Made&quot;</a:s>
                     </a:s>
                     <a:s>
      then </a:s>
                     <a:s r="199">
                        <a:s r="197">
                           <a:s r="156">
                              <a:s>'Dose 2 of the Hepatitis B, adjuvanted vaccine (CVX 189) is recommended to be administered on '</a:s>
                           </a:s>
                           <a:s> + </a:s>
                           <a:s r="196">
                              <a:s>ToString(</a:s>
                              <a:s r="195">
                                 <a:s r="193">
                                    <a:s>&quot;Most Recent Hep B Adjuvanted Administration Date&quot;</a:s>
                                 </a:s>
                                 <a:s> + </a:s>
                                 <a:s r="194">
                                    <a:s>28 days</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s> + </a:s>
                        <a:s r="198">
                           <a:s>'.'</a:s>
                        </a:s>
                     </a:s>
                  </a:s>
                  <a:s>
    </a:s>
                  <a:s r="211">
                     <a:s>when </a:s>
                     <a:s r="209">
                        <a:s>&quot;Patient has Completed the Hep B Adult Series&quot;</a:s>
                     </a:s>
                     <a:s>
      then </a:s>
                     <a:s r="210">
                        <a:s>'The patient has already received 2 doses of the Hepatitis B, adjuvanted vaccine (CVX 189), and has completed the series. No additional doses are recommeneded at this time.'</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
    else
      </a:s>
                  <a:s r="212">
                     <a:s>'A forecast could not be determined at this time.'</a:s>
                  </a:s>
                  <a:s>
  end</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="213" locator="63:3-72:5" xsi:type="Case">
            <caseItem localId="146" locator="64:5-65:152">
               <when localId="137" locator="64:10-64:59" name="A Forecast for Hep B Adult Dose 1 Should be Made" xsi:type="ExpressionRef"/>
               <then localId="145" locator="65:12-65:152" xsi:type="Concatenate">
                  <operand localId="143" locator="65:12-65:146" xsi:type="Concatenate">
                     <operand localId="138" locator="65:12-65:106" valueType="t:String" value="Dose 1 of the Hepatitus B, adjuvanted vaccine (CVX 189) is recommended to be administered on " xsi:type="Literal"/>
                     <operand localId="142" locator="65:110-65:146" xsi:type="ToString">
                        <operand localId="141" locator="65:119-65:145" xsi:type="Add">
                           <operand localId="139" locator="65:119-65:134" name="PatientBirthDate" xsi:type="ExpressionRef"/>
                           <operand localId="140" locator="65:138-65:145" value="18" unit="years" xsi:type="Quantity"/>
                        </operand>
                     </operand>
                  </operand>
                  <operand localId="144" locator="65:150-65:152" valueType="t:String" value="." xsi:type="Literal"/>
               </then>
            </caseItem>
            <caseItem localId="200" locator="66:5-67:185">
               <when localId="155" locator="66:10-66:59" name="A Forecast for Hep B Adult Dose 2 Should be Made" xsi:type="ExpressionRef"/>
               <then localId="199" locator="67:12-67:185" xsi:type="Concatenate">
                  <operand localId="197" locator="67:12-67:179" xsi:type="Concatenate">
                     <operand localId="156" locator="67:12-67:106" valueType="t:String" value="Dose 2 of the Hepatitis B, adjuvanted vaccine (CVX 189) is recommended to be administered on " xsi:type="Literal"/>
                     <operand localId="196" locator="67:110-67:179" xsi:type="ToString">
                        <operand localId="195" locator="67:119-67:178" xsi:type="Add">
                           <operand asType="t:DateTime" xsi:type="As">
                              <operand localId="193" locator="67:119-67:168" name="Most Recent Hep B Adjuvanted Administration Date" xsi:type="ExpressionRef"/>
                           </operand>
                           <operand localId="194" locator="67:172-67:178" value="28" unit="days" xsi:type="Quantity"/>
                        </operand>
                     </operand>
                  </operand>
                  <operand localId="198" locator="67:183-67:185" valueType="t:String" value="." xsi:type="Literal"/>
               </then>
            </caseItem>
            <caseItem localId="211" locator="68:5-69:184">
               <when localId="209" locator="68:10-68:55" name="Patient has Completed the Hep B Adult Series" xsi:type="ExpressionRef"/>
               <then localId="210" locator="69:12-69:184" valueType="t:String" value="The patient has already received 2 doses of the Hepatitis B, adjuvanted vaccine (CVX 189), and has completed the series. No additional doses are recommeneded at this time." xsi:type="Literal"/>
            </caseItem>
            <else localId="212" locator="71:7-71:56" valueType="t:String" value="A forecast could not be determined at this time." xsi:type="Literal"/>
         </expression>
      </def>
      <def localId="261" locator="127:1-139:10" name="Second Valid Hep B Adjuvanted Adult Dose" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="261">
               <a:s>define &quot;Second Valid Hep B Adjuvanted Adult Dose&quot;:
  </a:s>
               <a:s r="260">
                  <a:s>if </a:s>
                  <a:s r="215">
                     <a:s>&quot;There Exists a Valid First Hep B Adjuvanted Dose&quot;</a:s>
                  </a:s>
                  <a:s>
    then
      </a:s>
                  <a:s r="258">
                     <a:s>First(
         </a:s>
                     <a:s r="257">
                        <a:s>
                           <a:s r="217">
                              <a:s r="216">
                                 <a:s>
                                    <a:s>&quot;Hep B Vaccine, Adjuvanted Immunization&quot;</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> I</a:s>
                           </a:s>
                        </a:s>
                        <a:s>
          </a:s>
                        <a:s>
                           <a:s>let </a:s>
                           <a:s r="220">
                              <a:s>firstDoseDate: </a:s>
                              <a:s r="219">
                                 <a:s r="218">
                                    <a:s>&quot;First Valid Hep B Adjuvanted Adult Dose&quot;</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="219">
                                    <a:s>occurrence</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>
          </a:s>
                        <a:s r="243">
                           <a:s>without </a:s>
                           <a:s r="222">
                              <a:s r="221">
                                 <a:s>
                                    <a:s>&quot;Hep B Vaccine, Adjuvanted Immunization&quot;</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> NI</a:s>
                           </a:s>
                           <a:s>
            // where the date is at least 24 days after the most recent shot of Hep B Adjuvant
            such that </a:s>
                           <a:s r="242">
                              <a:s r="234">
                                 <a:s r="227">
                                    <a:s r="225">
                                       <a:s r="224">
                                          <a:s r="223">
                                             <a:s>NI</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="224">
                                             <a:s>occurrence</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="225">
                                          <a:s>value</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s> is </a:s>
                                    <a:s r="226">
                                       <a:s>DateTime</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> and </a:s>
                                 <a:s r="233">
                                    <a:s r="230">
                                       <a:s r="229">
                                          <a:s r="228">
                                             <a:s>NI</a:s>
                                          </a:s>
                                          <a:s>.</a:s>
                                          <a:s r="229">
                                             <a:s>occurrence</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="230">
                                          <a:s>value</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s r="233"> after </a:s>
                                    <a:s r="232">
                                       <a:s r="231">
                                          <a:s>firstDoseDate</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="232">
                                          <a:s>value</a:s>
                                       </a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                              <a:s> and </a:s>
                              <a:s r="241">
                                 <a:s r="237">
                                    <a:s r="236">
                                       <a:s r="235">
                                          <a:s>NI</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="236">
                                          <a:s>occurrence</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="237">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s r="241"> before </a:s>
                                 <a:s r="240">
                                    <a:s r="239">
                                       <a:s r="238">
                                          <a:s>I</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="239">
                                          <a:s>occurrence</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="240">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>
          </a:s>
                        <a:s r="256">
                           <a:s>where </a:s>
                           <a:s r="256">
                              <a:s r="248">
                                 <a:s r="246">
                                    <a:s r="245">
                                       <a:s r="244">
                                          <a:s>I</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="245">
                                          <a:s>occurrence</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="246">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> is </a:s>
                                 <a:s r="247">
                                    <a:s>DateTime</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> and </a:s>
                              <a:s r="255">
                                 <a:s r="251">
                                    <a:s r="250">
                                       <a:s r="249">
                                          <a:s>I</a:s>
                                       </a:s>
                                       <a:s>.</a:s>
                                       <a:s r="250">
                                          <a:s>occurrence</a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="251">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> </a:s>
                                 <a:s r="255">
                                    <a:s r="254">
                                       <a:s>24 days</a:s>
                                    </a:s>
                                    <a:s> or more after</a:s>
                                 </a:s>
                                 <a:s> </a:s>
                                 <a:s r="253">
                                    <a:s r="252">
                                       <a:s>firstDoseDate</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="253">
                                       <a:s>value</a:s>
                                    </a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>
        )</a:s>
                  </a:s>
                  <a:s r="259">
    else
      null</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="260" locator="128:3-139:10" xsi:type="If">
            <condition localId="215" locator="128:6-128:55" name="There Exists a Valid First Hep B Adjuvanted Dose" xsi:type="ExpressionRef"/>
            <then localId="258" locator="130:7-137:9" xsi:type="First">
               <source localId="257" locator="131:10-136:111" xsi:type="Query">
                  <source localId="217" locator="131:10-131:51" alias="I">
                     <expression localId="216" locator="131:10-131:49" name="Hep B Vaccine, Adjuvanted Immunization" xsi:type="ExpressionRef"/>
                  </source>
                  <let localId="220" locator="132:15-132:81" identifier="firstDoseDate">
                     <expression localId="219" locator="132:30-132:81" path="occurrence" xsi:type="Property">
                        <source localId="218" locator="132:30-132:70" name="First Valid Hep B Adjuvanted Adult Dose" xsi:type="ExpressionRef"/>
                     </expression>
                  </let>
                  <relationship localId="243" locator="133:11-135:153" alias="NI" xsi:type="Without">
                     <expression localId="221" locator="133:19-133:58" name="Hep B Vaccine, Adjuvanted Immunization" xsi:type="ExpressionRef"/>
                     <suchThat localId="242" locator="135:23-135:153" xsi:type="And">
                        <operand localId="234" locator="135:23-135:103" xsi:type="And">
                           <operand localId="227" locator="135:23-135:53" xsi:type="Is">
                              <operand localId="225" locator="135:23-135:41" path="value" xsi:type="Property">
                                 <source localId="224" locator="135:23-135:35" path="occurrence" scope="NI" xsi:type="Property"/>
                              </operand>
                              <isTypeSpecifier localId="226" locator="135:46-135:53" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                           </operand>
                           <operand localId="233" locator="135:59-135:103" xsi:type="After">
                              <operand asType="t:DateTime" xsi:type="As">
                                 <operand localId="230" locator="135:59-135:77" path="value" xsi:type="Property">
                                    <source localId="229" locator="135:59-135:71" path="occurrence" scope="NI" xsi:type="Property"/>
                                 </operand>
                              </operand>
                              <operand asType="t:DateTime" xsi:type="As">
                                 <operand localId="232" locator="135:85-135:103" path="value" xsi:type="Property">
                                    <source localId="231" locator="135:85-135:97" name="firstDoseDate" xsi:type="QueryLetRef"/>
                                 </operand>
                              </operand>
                           </operand>
                        </operand>
                        <operand localId="241" locator="135:109-135:153" xsi:type="Before">
                           <operand asType="t:DateTime" xsi:type="As">
                              <operand localId="237" locator="135:109-135:127" path="value" xsi:type="Property">
                                 <source localId="236" locator="135:109-135:121" path="occurrence" scope="NI" xsi:type="Property"/>
                              </operand>
                           </operand>
                           <operand asType="t:DateTime" xsi:type="As">
                              <operand localId="240" locator="135:136-135:153" path="value" xsi:type="Property">
                                 <source localId="239" locator="135:136-135:147" path="occurrence" scope="I" xsi:type="Property"/>
                              </operand>
                           </operand>
                        </operand>
                     </suchThat>
                  </relationship>
                  <where localId="256" locator="136:11-136:111" xsi:type="And">
                     <operand localId="248" locator="136:17-136:46" xsi:type="Is">
                        <operand localId="246" locator="136:17-136:34" path="value" xsi:type="Property">
                           <source localId="245" locator="136:17-136:28" path="occurrence" scope="I" xsi:type="Property"/>
                        </operand>
                        <isTypeSpecifier localId="247" locator="136:39-136:46" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </operand>
                     <operand localId="255" locator="136:52-136:111" xsi:type="SameOrAfter">
                        <operand asType="t:DateTime" xsi:type="As">
                           <operand localId="251" locator="136:52-136:69" path="value" xsi:type="Property">
                              <source localId="250" locator="136:52-136:63" path="occurrence" scope="I" xsi:type="Property"/>
                           </operand>
                        </operand>
                        <operand locator="136:107-136:111" xsi:type="Add">
                           <operand asType="t:DateTime" xsi:type="As">
                              <operand localId="253" locator="136:93-136:111" path="value" xsi:type="Property">
                                 <source localId="252" locator="136:93-136:105" name="firstDoseDate" xsi:type="QueryLetRef"/>
                              </operand>
                           </operand>
                           <operand localId="254" locator="136:71-136:77" value="24" unit="days" xsi:type="Quantity"/>
                        </operand>
                     </operand>
                  </where>
               </source>
            </then>
            <else asType="fhir:Immunization" xsi:type="As">
               <operand localId="259" locator="139:7-139:10" xsi:type="Null"/>
            </else>
         </expression>
      </def>
   </statements>
</library>
